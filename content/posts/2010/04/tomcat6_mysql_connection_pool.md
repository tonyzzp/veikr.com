```toml
title = "tomcat6+mysql连接池的简单实现(亲自试验通过)"
slug = "tomcat6_mysql_connection_pool"
description = ""
date = "2010-04-23 15:03:07"
author = "admin"
tags = ["mysql","tomcat","连接池"]
```

<p>在网上找了很久，文章都是你抄、我抄你。看来看去都一样的，google往后翻N页&#160; 进去一看都是一样的。郁闷至极。</p>  <p>于上是CSDN论坛求助，还是java\web坛子里的朋友热情些，终于算是搞好了，自己再试了下，把心得发出来大家指点指点。</p>  <p><font color="#0080ff">1、mysql-connector-java-5.0.8-bin.jar文件，也就是mysql驱动包。<font color="#ff0000">注意：要放到tomcat6/lib目录下。放到web-inf/lib下不行</font>，不知道为什么，我会再试试。</font></p>  <p><font color="#0080ff">2、修改tomcat6/conf/context.xml文件，以&lt;context&gt;标签之间加上</font></p>  <pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  1: &lt;Resource name=&quot;<span style="color: #8b0000">jdbc/mysql</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  2: 		auth=&quot;<span style="color: #8b0000">Container</span>&quot;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  3: 		type=&quot;<span style="color: #8b0000">javax.sql.DataSource</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  4: 		driverClassName=&quot;<span style="color: #8b0000">com.mysql.jdbc.Driver</span>&quot;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  5: 		url=&quot;<span style="color: #8b0000">jdbc:mysql://localhost:3306/test</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  6: 		username=&quot;<span style="color: #8b0000">root</span>&quot;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  7: 		password=&quot;<span style="color: #8b0000">root</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  8: 		maxActive=&quot;<span style="color: #8b0000">100</span>&quot;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  9: 		maxIdle=&quot;<span style="color: #8b0000">30</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 10: 	maxWait=&quot;<span style="color: #8b0000">5000</span>&quot; /&gt;</pre></pre><p>&#160;</p><p>意思应该一看就能明白，就不解释了。</p><p><font color="#0080ff">3、测试页面</font></p><pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  1: &lt;!doctype html <span style="color: #0000ff">public</span> &quot;<span style="color: #8b0000">-//w3c//dtd html 4.0 transtional//en</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  2: &quot;<span style="color: #8b0000">help://www.w3.org/TR/REC-html40/strict.dtd</span>&quot;&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  3: &lt;%@ page <span style="color: #0000ff">import</span>=&quot;<span style="color: #8b0000">java.sql.*,javax.sql.*,javax.naming.*</span>&quot; session=&quot;<span style="color: #8b0000">false</span>&quot; %&gt;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  4: &lt;html&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  5: &lt;head&gt;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  6: &lt;meta http-equive=&quot;<span style="color: #8b0000">Content-Type</span>&quot; content=&quot;<span style="color: #8b0000">text/html</span>&quot;; charset=&quot;<span style="color: #8b0000">gbk</span>&quot;&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  7: &lt;title&gt;&lt;/title&gt;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  8: &lt;body&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  9: </pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 10: &lt;%</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 11: out.println(&quot;<span style="color: #8b0000">开始测试!</span>&quot;);</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 12: DataSource ds;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 13: InitialContext ctx;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 14: <span style="color: #0000ff">try</span>{</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 15: 	ctx=<span style="color: #0000ff">new</span> InitialContext();</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 16: 	ds=(DataSource)ctx.lookup(&quot;<span style="color: #8b0000">java:comp/env/jdbc/mysql</span>&quot;);</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 17: 	Connection con=ds.getConnection();</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 18: 	Statement stmt=con.createStatement();</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 19: 	String sql=&quot;<span style="color: #8b0000">select * from person</span>&quot;;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 20: 	ResultSet rs=stmt.executeQuery(sql);</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 21: 	<span style="color: #0000ff">while</span>(rs.next()){</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 22: 		out.println(rs.getString(2));</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 23: 	}</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 24: 	out.println(&quot;<span style="color:
#8b0000">测试成功！</span>&quot;);</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 25: }</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 26: <span style="color: #0000ff">catch</span>(Exception e){</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 27: 	out.println(e.toString());</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 28: }</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 29: </pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 30: %&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 31: &lt;/body&gt;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 32: &lt;/html&gt;</pre></pre><pre>大功告成！！</pre><pre>&#160;</pre><pre><font color="#ff0080">提示：有人说还要在web-inf/web.xml里加些东西。经试验，完全不需要的。</font></pre>


<!--more-->

<p>在网上找了很久，文章都是你抄、我抄你。看来看去都一样的，google往后翻N页&#160; 进去一看都是一样的。郁闷至极。</p>  <p>于上是CSDN论坛求助，还是java\web坛子里的朋友热情些，终于算是搞好了，自己再试了下，把心得发出来大家指点指点。</p>  <p><font color="#0080ff">1、mysql-connector-java-5.0.8-bin.jar文件，也就是mysql驱动包。<font color="#ff0000">注意：要放到tomcat6/lib目录下。放到web-inf/lib下不行</font>，不知道为什么，我会再试试。</font></p>  <p><font color="#0080ff">2、修改tomcat6/conf/context.xml文件，以&lt;context&gt;标签之间加上</font></p>  <pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  1: &lt;Resource name=&quot;<span style="color: #8b0000">jdbc/mysql</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  2: 		auth=&quot;<span style="color: #8b0000">Container</span>&quot;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  3: 		type=&quot;<span style="color: #8b0000">javax.sql.DataSource</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  4: 		driverClassName=&quot;<span style="color: #8b0000">com.mysql.jdbc.Driver</span>&quot;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  5: 		url=&quot;<span style="color: #8b0000">jdbc:mysql://localhost:3306/test</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  6: 		username=&quot;<span style="color: #8b0000">root</span>&quot;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  7: 		password=&quot;<span style="color: #8b0000">root</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  8: 		maxActive=&quot;<span style="color: #8b0000">100</span>&quot;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  9: 		maxIdle=&quot;<span style="color: #8b0000">30</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 10: 	maxWait=&quot;<span style="color: #8b0000">5000</span>&quot; /&gt;</pre></pre><p>&#160;</p><p>意思应该一看就能明白，就不解释了。</p><p><font color="#0080ff">3、测试页面</font></p><pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  1: &lt;!doctype html <span style="color: #0000ff">public</span> &quot;<span style="color: #8b0000">-//w3c//dtd html 4.0 transtional//en</span>&quot;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  2: &quot;<span style="color: #8b0000">help://www.w3.org/TR/REC-html40/strict.dtd</span>&quot;&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  3: &lt;%@ page <span style="color: #0000ff">import</span>=&quot;<span style="color: #8b0000">java.sql.*,javax.sql.*,javax.naming.*</span>&quot; session=&quot;<span style="color: #8b0000">false</span>&quot; %&gt;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  4: &lt;html&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  5: &lt;head&gt;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  6: &lt;meta http-equive=&quot;<span style="color: #8b0000">Content-Type</span>&quot; content=&quot;<span style="color: #8b0000">text/html</span>&quot;; charset=&quot;<span style="color: #8b0000">gbk</span>&quot;&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  7: &lt;title&gt;&lt;/title&gt;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  8: &lt;body&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px">  9: </pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 10: &lt;%</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 11: out.println(&quot;<span style="color: #8b0000">开始测试!</span>&quot;);</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 12: DataSource ds;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 13: InitialContext ctx;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 14: <span style="color: #0000ff">try</span>{</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 15: 	ctx=<span style="color: #0000ff">new</span> InitialContext();</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 16: 	ds=(DataSource)ctx.lookup(&quot;<span style="color: #8b0000">java:comp/env/jdbc/mysql</span>&quot;);</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 17: 	Connection con=ds.getConnection();</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 18: 	Statement stmt=con.createStatement();</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 19: 	String sql=&quot;<span style="color: #8b0000">select * from person</span>&quot;;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 20: 	ResultSet rs=stmt.executeQuery(sql);</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 21: 	<span style="color: #0000ff">while</span>(rs.next()){</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 22: 		out.println(rs.getString(2));</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 23: 	}</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 24: 	out.println(&quot;<span style="color:
#8b0000">测试成功！</span>&quot;);</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 25: }</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 26: <span style="color: #0000ff">catch</span>(Exception e){</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 27: 	out.println(e.toString());</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 28: }</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 29: </pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 30: %&gt;</pre><pre style="background-color: #eaeaea; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 31: &lt;/body&gt;</pre><pre style="background-color: #ffffff; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; font-size: 12px"> 32: &lt;/html&gt;</pre></pre><pre>大功告成！！</pre><pre>&#160;</pre><pre><font color="#ff0080">提示：有人说还要在web-inf/web.xml里加些东西。经试验，完全不需要的。</font></pre>
